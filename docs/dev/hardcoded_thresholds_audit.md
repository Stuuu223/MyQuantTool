# 硬编码阈值审计清单

> 本文档记录项目中的硬编码阈值，用于"去硬编码专项"。
> 审计进行中，持续更新中...

---

## 审计说明

- **审计范围**：logic/、backtest/、scripts/ 等核心代码目录
- **审计方法**：手工排查 + 代码搜索
- **审计状态**：进行中（当前完成资金相关部分）

---

## 一、资金相关阈值

### 1.1 ratio 阈值

| 文件路径 | 行号 | 阈值 | 语义说明 | 当前依据 | 是否合理 |
|---------|------|------|----------|----------|----------|
| `logic/core/trade_gatekeeper.py` | 313 | `ratio < 0.5` | 资金推动力低于0.5% | 无依据 | ❌ 否 |
| `logic/core/trade_gatekeeper.py` | 317 | `ratio > 5` | 资金推动力高于500% | 无依据 | ❌ 否 |

### 1.2 资金流入阈值

| 文件路径 | 行号 | 阈值 | 语义说明 | 当前依据 | 是否合理 |
|---------|------|------|----------|----------|----------|
| `logic/analyzers/capital_classifier.py` | 217 | `> 5000` | 机构流入大于5000万 | 无依据 | ❌ 否 |
| `logic/analyzers/trap_detector.py` | 260 | `< 1000` | 流入低于1000万 | 无依据 | ❌ 否 |
| `logic/analyzers/trap_detector.py` | 287 | `> 10000` | 流入大于1亿 | 无依据 | ❌ 否 |

---

## 二、量比阈值

| 文件路径 | 行号 | 阈值 | 语义说明 | 当前依据 | 是否合理 |
|---------|------|------|----------|----------|----------|
| `logic/core/algo.py` | 834 | `> 2` | 量比大于2倍 | 无依据 | ❌ 否 |
| `logic/core/algo.py` | 837 | `> 1.5` | 量比大于1.5倍 | 无依据 | ❌ 否 |
| `logic/core/algo.py` | 840 | `< 0.5` | 量比小于0.5倍 | 无依据 | ❌ 否 |

---

## 三、涨跌幅阈值

| 文件路径 | 行号 | 阈值 | 语义说明 | 当前依据 | 是否合理 |
|---------|------|------|----------|----------|----------|
| `logic/core/algo.py` | 496 | `< 0.05` | 价格波动低于5% | 无依据 | ❌ 否 |
| `logic/core/algo.py` | 2618 | `> 0.03` | 波动率高于3% | 无依据 | ❌ 否 |
| `logic/core/algo.py` | 2621 | `> 0.02` | 波动率高于2% | 无依据 | ❌ 否 |

---

## 四、去硬编码专项

### 优先级 P0（高优先级）

1. **ratio 阈值重构**
   - 文件：`logic/core/trade_gatekeeper.py:313, 317`
   - 改造方案：使用 `logic/strategies/dynamic_threshold.py` 的市值分档
   - 状态：待开始

2. **资金流入阈值重构**
   - 文件：`logic/analyzers/capital_classifier.py:217`
   - 改造方案：使用 ratio = main_net_inflow / circulating_cap
   - 状态：待开始

3. **量比阈值重构**
   - 文件：`logic/core/algo.py:834, 837, 840`
   - 改造方案：移到配置文件
   - 状态：待开始

---

## 五、统计信息

- **已审计文件数**：3个
- **已发现硬编码数**：9处
- **标记为"无依据"**：9处
- **待审计文件**：待续

---

**审计人**：AI项目总监  
**审计日期**：2026-02-18  
**更新频率**：持续更新中