# 开发前必读检查清单

> **每次开发前必须先读取此清单，确保不违反铁律**
>
> **版本**: V11.0  
> **更新日期**: 2026-02-12

---

## 🔴 核心铁律（必须遵守）

### 铁律0：基于现实情况深度分析，禁止糊弄
- [ ] 是否深度阅读相关代码（read_file、glob、search_file_content）？
- [ ] 是否理解数据流向（追踪实际路径）？
- [ ] 是否验证假设（通过工具或交互）？
- [ ] 是否与用户交互确认模糊需求？
- [ ] 是否记录分析过程（详细推理步骤）？
- [ ] ✅ 通过 → 继续下一步
- [ ] ❌ 不通过 → 拒绝开发，必须深度分析

### 铁律1：事件驱动架构
- [ ] 是否采用事件驱动架构？
- [ ] 是否避免定时批量扫描？
- [ ] ✅ 通过 → 继续下一步
- [ ] ❌ 不通过 → 拒绝开发，必须重构为事件驱动

### 铁律2：Tick数据（非分钟K）
- [ ] 实时决策是否使用Tick数据（3秒延迟）？
- [ ] 是否避免降级到分钟K（60秒延迟）？
- [ ] ✅ 通过 → 继续下一步
- [ ] ❌ 不通过 → 拒绝开发，必须使用Tick数据

### 铁律3：三把斧完整
- [ ] 防守斧（禁止场景拦截）是否完整？
- [ ] 时机斧（板块共振检查）是否完整？
- [ ] 资金斧（ratio决策树）是否完整？
- [ ] ✅ 通过 → 继续下一步
- [ ] ❌ 不通过 → 拒绝开发，三把斧缺一不可

### 铁律4：板块共振检查
- [ ] 是否检查板块共振（Leaders≥3, Breadth≥35%）？
- [ ] 未满足共振时是否降级到观察池？
- [ ] ✅ 通过 → 继续下一步
- [ ] ❌ 不通过 → 拒绝开发，必须添加板块共振检查

### 铁律5：数据抽象层
- [ ] 策略层是否通过抽象层（ICapitalFlowProvider）访问数据？
- [ ] 是否避免直接调用数据源API（xtquant、akshare）？
- [ ] ✅ 通过 → 继续下一步
- [ ] ❌ 不通过 → 拒绝开发，必须使用抽象层

### 铁律6：ratio决策树
- [ ] 买入决策是否基于ratio（主力净流入/流通市值）？
- [ ] 是否避免用其他指标替代ratio？
- [ ] ✅ 通过 → 继续下一步
- [ ] ❌ 不通过 → 拒绝开发，必须使用ratio决策树

### 铁律7：诱多检测
- [ ] 是否实现诱多检测（单日暴量+隔日反手等）？
- [ ] 诱多股票是否加入黑名单？
- [ ] ✅ 通过 → 继续下一步
- [ ] ❌ 不通过 → 拒绝开发，必须添加诱多检测

### 铁律8：Level-2可选
- [ ] 系统是否支持Level-1（免费）？
- [ ] Level-2是否为可选（不强制依赖）？
- [ ] ✅ 通过 → 继续下一步
- [ ] ❌ 不通过 → 拒绝开发，Level-2必须是可选的

### 铁律9：状态指纹对比
- [ ] 是否生成状态指纹（MD5）？
- [ ] 是否只在状态变化时保存快照？
- [ ] ✅ 通过 → 继续下一步
- [ ] ❌ 不通过 → 拒绝开发，必须添加状态指纹对比

### 铁律10：归档说明清晰
- [ ] 归档/删除代码是否有README说明？
- [ ] README是否包含：归档原因、致命缺陷、替代方案、保留价值？
- [ ] ✅ 通过 → 继续下一步
- [ ] ❌ 不通过 → 拒绝开发，必须写清楚归档说明

---

## 🟢 开发流程

### 第1步：读取完整指南
```
读取文件: .iflow/V11_DEVELOPMENT_GUIDE.md
```

### 第2步：检查是否违反铁律
```
逐项检查上述10条铁律
```

### 第3步：如有疑问，询问用户
```
"这个功能是否违反铁律X？"
"这个方案是否符合铁律Y？"
```

### 第4步：开始开发
```
在确保不违反铁律的前提下，开始开发
```

---

## ⚠️ 违反铁律的后果

1. **代码拒绝合并** - CI/CD自动检测
2. **必须重构** - 不允许绕过铁律
3. **可能导致实盘亏损** - 风控缺失

---

## 📞 快速参考

### V11核心文件
- `tasks/run_event_driven_monitor.py` - 事件驱动监控器
- `logic/full_market_scanner.py` - 三把斧系统
- `logic/sector_resonance.py` - 板块共振
- `logic/trap_detector.py` - 诱多检测

### 数据抽象层（待创建）
- `logic/data_provider/base.py` - 接口定义
- `logic/data_provider/factory.py` - 工厂
- `logic/data_provider/level1_provider.py` - Level-1实现
- `logic/data_provider/level2_provider.py` - Level-2实现（预留）

### 配置文件
- `config/market_scan_config.json` - 市场扫描配置

---

## 📋 口诀（方便记忆）

```
铁律0：深度分析不糊弄，不读代码直接生成 → 拒绝
铁律1：事件驱动是核心，Tick数据不能丢
铁律2：三把斧头要齐全，板块共振看清楚
铁律3：抽象层级要遵守，ratio决策是基础
铁律4：诱多检测必须有，Level-2可选走
铁律5：状态指纹要对比，归档说明要留够
```

---

**记住：违反铁律 = 拒绝开发**