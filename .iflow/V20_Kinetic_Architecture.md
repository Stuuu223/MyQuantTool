# V20 åŠ¨èƒ½æ¶æ„é‡æ„ - å®å¾®è§‚ç»“åˆå››æ­¥çŒæ€æ³•

**æ–‡æ¡£ç‰ˆæœ¬:** V20.4 å¤§é“è‡³ç®€Â·æ¸¸èµ„å¿ƒæ³•ç‰ˆ  
**åˆ¶å®šæ—¥æœŸ:** 2026-02-26  
**åˆ¶å®šäºº:** CTO + Bossæˆ˜ç•¥æŒ‡å¯¼  
**æ‰§è¡Œäºº:** AIé¡¹ç›®æ€»ç›‘ + å¼€å‘å›¢é˜Ÿ  

---

## ä¸€ã€æˆ˜ç•¥èƒŒæ™¯

BossæŒ‡å‡ºå½“å‰ç³»ç»Ÿä¸‰å¤§è‡´å‘½é—®é¢˜ï¼š
1. **ç¥¨å¤ªéš¾çœ‹** - é€‰å‡ºçš„éƒ½æ˜¯å…­å›½åŒ–å·¥ç­‰æ­»æ°´å¤§ç›˜ç¥¨
2. **åªæ‰«ä¸€æ¬¡å°±åœ** - æ²¡æœ‰åŠ¨æ€å·¡èˆªæœºåˆ¶
3. **Magic Numberæ³›æ»¥** - 1%æ¢æ‰‹ç‡æ˜¯é—­é—¨é€ è½¦ï¼Œä¸ç¬¦åˆAè‚¡å®é™…

**æ ¸å¿ƒæˆ˜ç•¥:**  
> "é¿å…æ— æ•ˆçš„å¸ƒæœ—è¿åŠ¨ã€‚Aè‚¡çš„è¶…å¼ºæµåŠ¨æ€§åªä½“ç°åœ¨ä¸»å‡ï¼Œ90%çš„ç¥¨90%çš„æ—¶é—´éƒ½åœ¨åšæ— æ•ˆçš„å¸ƒæœ—è¿åŠ¨ã€‚å…ˆç²—ç­›å‡ºæ¥ä¸»å‡è¶‹åŠ¿çš„ç¥¨ï¼Œåˆ†æåŠ¨èƒ½ã€åŠ¿èƒ½ï¼Œé¡ºåŠ¿è€Œä¸ºï¼Œèµ„é‡‘ä¸ºç‹ï¼Œç„¶åRankå¹²å¤§å“¥ã€‚"

---

## äºŒã€å…¨å±€æ¶æ„ï¼šå®å¾®è§‚å››æ­¥çŒæ€æ³•

### ğŸ—¡ï¸ Phase 0: è‚ƒæ¸…Magic Numberï¼Œå…¨é¢RatioåŒ–

**é—®é¢˜:** ä»£ç ä¸­å¤§é‡ç¡¬ç¼–ç æ•°å­—ï¼ˆ1%æ¢æ‰‹ã€1.5é‡æ¯”é˜ˆå€¼ç­‰ï¼‰  
**æ–¹æ¡ˆ:** æ‰€æœ‰é˜ˆå€¼æ”¹ä¸ºåŸºäºå¸‚åœºåŠ¨æ€åˆ†ä½æ•°å’Œä¸ªè‚¡å†å²Ratio

**å…·ä½“æªæ–½:**
1. **é‡æ¯”åˆ†ä½æ•°** - ä¿ç•™0.90åˆ†ä½åŠ¨æ€é˜ˆå€¼ï¼ˆå·²å®Œæˆï¼‰
2. **æ¢æ‰‹ç‡RatioåŒ–** - `Turnover_Ratio = ä»Šæ—¥ä¼°ç®—å…¨å¤©æ¢æ‰‹ç‡ / 5æ—¥å¹³å‡æ¢æ‰‹ç‡`
3. **å…¨éƒ¨å‚æ•°ConfigåŒ–** - å†™å…¥strategy_params.jsonï¼Œé›¶ç¡¬ç¼–ç 

---

### ğŸ—¡ï¸ Phase 1: å®è§‚åŠ¿èƒ½è¿‡æ»¤ï¼ˆè¿‡æ»¤å¸ƒæœ—è¿åŠ¨ï¼Œåªè¦ä¸»å‡ï¼‰

**ç›®æ ‡:** åªåšä¸»å‡æµªçš„ç¥¨ï¼Œæ‹’ç»æ¥é£åˆ€  
**æ ¸å¿ƒé€»è¾‘:** å¤§é“è‡³ç®€ - å‡çº¿å¤šå¤´æ’åˆ—

**ç­›é€‰æ¡ä»¶ï¼ˆå¿…é¡»åŒæ—¶æ»¡è¶³ï¼‰:**
1. **è¶‹åŠ¿é˜²çº¿** - `MA5 >= MA10` ä¸” `æ˜¨æ—¥æ”¶ç›˜ä»· >= MA20`
2. **èµ„é‡‘æ´»è·ƒåº¦Ratio** - `Turnover_Ratio > 1.5`ï¼ˆä»Šå¤©æ¯”å¹³æ—¶æ´»è·ƒ50%ä»¥ä¸Šï¼‰
3. **å¤§å“¥èµ·æ­¥çº¿** - `ä»Šæ—¥ä¼°ç®—å…¨å¤©æ¢æ‰‹ç‡ >= 5.0%`ï¼ˆæ— 5%ä¸å¦–è‚¡ï¼‰
4. **æ­»äº¡æ¢æ‰‹ç†”æ–­** - `ä»Šæ—¥ä¼°ç®—å…¨å¤©æ¢æ‰‹ç‡ <= 60.0%`ï¼ˆè§„é¿ç­¹ç æ–­å±‚ï¼‰
5. **é‡æ¯”åˆ†ä½æ•°** - `volume_ratio >= å…¨å¸‚åœº0.90åˆ†ä½`

**æ•°æ®æ¥æº:**
- MA5/MA10/MA20: QMTæœ¬åœ°æ—¥Kæ•°æ®
- 5æ—¥å¹³å‡æ¢æ‰‹ç‡: TrueDictionary
- é‡æ¯”: å®æ—¶è®¡ç®—ï¼ˆæ—¶é—´è¿›åº¦åŠ æƒï¼‰

---

### ğŸ—¡ï¸ Phase 2: åŠ¨æ€é›·è¾¾60ç§’æé€Ÿå·¡èˆªï¼ˆä¿æŒæ± å­æ´»æ°´ï¼‰

**é—®é¢˜:** å½“å‰ç³»ç»Ÿåªåœ¨å¯åŠ¨æ—¶æ‰«ä¸€æ¬¡ï¼Œåˆ»èˆŸæ±‚å‰‘  
**æ–¹æ¡ˆ:** 60ç§’ä¸€æ¬¡å…¨å¸‚åœºå¿«ç…§æ‰«æ

**å®ç°æœºåˆ¶:**
1. åœ¨`_fire_control_mode`ä¸­æ·»åŠ `while True:`ä¸»å¾ªç¯
2. è®°å½•`last_scan_time`ï¼Œæ¯60ç§’è§¦å‘ä¸€æ¬¡`_catch_up_mid_day()`
3. åŠ¨æ€å¯¹æ¯”æ–°æ—§watchlist:
   - æ–°æ™‹è‚¡ç¥¨ï¼šè¡¥å……Tickè®¢é˜…
   - æ‰é˜Ÿè‚¡ç¥¨ï¼šå–æ¶ˆè®¢é˜…ï¼ˆå¯é€‰ï¼‰
4. è¾“å‡ºæ‰«ææ—¥å¿—ï¼š
   ```
   [CTOé›·è¾¾å·¡èˆª] ç¬¬Næ¬¡æ‰«æå®Œæˆ | è§‚å¯Ÿæ± : XXåª | æ–°æ™‹: Xåª | æ‰é˜Ÿ: Xåª
   ```

**æŠ€æœ¯è¦ç‚¹:**
- `xtdata.get_full_tick()`å…¨å¸‚åœº5000åªè‚¡ç¥¨ä»…éœ€å‡ åæ¯«ç§’
- 60ç§’é—´éš”å¯¹CPUå’ŒQMTæ— å‹åŠ›
- å¿…é¡»ä½¿ç”¨ç‹¬ç«‹çº¿ç¨‹ï¼Œé¿å…é˜»å¡Tickå›è°ƒ

---

### ğŸ—¡ï¸ Phase 3: æ„å»ºå¾®è§‚ç‰©ç†å¼•æ“(KineticEnergyCalculator)

**ç›®æ ‡:** ç”¨ç‰©ç†æ€ç»´è®¡ç®—Tickçº§åŠ¨èƒ½  
**æ ¸å¿ƒæŒ‡æ ‡:**

1. **ç¬æ—¶æ¶¨é€Ÿ(Velocity)**
   - å…¬å¼: `(å½“å‰Tickä»·æ ¼ - 60ç§’å‰Tickä»·æ ¼) / æ˜¨æ”¶ä»· * 100%`
   - æ„ä¹‰: ä¸ç®¡-5%è¿˜æ˜¯+5%ï¼Œåªè¦ä¸€åˆ†é’Ÿå†…æ‹‰å‡1.5%+å°±æ˜¯ç‚¹ç«

2. **åŠ¨èƒ½æ¢æ‰‹(Burst Turnover)**
   - å…¬å¼: `è¿‡å»60ç§’å†…ç´¯è®¡æˆäº¤é‡ / æµé€šè‚¡æœ¬ * 100%`
   - æ„ä¹‰: æ¶¨é€Ÿå¿…é¡»ä¼´éšçˆ†é‡ï¼Œæ‰æ˜¯ä¸»åŠ›çœŸå®æ‰«è´§

3. **åŠ¨èƒ½åŠ é€Ÿåº¦(Acceleration)**
   - é€»è¾‘: 60ç§’å†…å¯†é›†åƒæ‰‹å¤§å• > é›¶æ˜Ÿæ•£æˆ·äº¤æ˜“
   - å®ç°: Tické¢‘ç‡åŠ æƒè®¡ç®—

**æŠ€æœ¯å®ç°:**
```python
# logic/execution/kinetic_engine.py
from collections import deque
import time

class KineticEnergyCalculator:
    def __init__(self, window_seconds=60):
        self.tick_window = deque(maxlen=1000)  # 60ç§’Tickçª—å£
        
    def on_tick(self, tick_data):
        # æ·»åŠ æ–°Tick
        self.tick_window.append({
            'timestamp': time.time(),
            'price': tick_data['price'],
            'volume': tick_data['volume']
        })
        
        # æ¸…ç†è¿‡æœŸTick
        cutoff_time = time.time() - self.window_seconds
        while self.tick_window and self.tick_window[0]['timestamp'] < cutoff_time:
            self.tick_window.popleft()
    
    def calculate_velocity(self, pre_close):
        """è®¡ç®—60ç§’æ¶¨é€Ÿ"""
        if len(self.tick_window) < 2:
            return 0.0
        old_price = self.tick_window[0]['price']
        new_price = self.tick_window[-1]['price']
        return (new_price - old_price) / pre_close * 100
    
    def calculate_burst_turnover(self, float_volume):
        """è®¡ç®—60ç§’åŠ¨èƒ½æ¢æ‰‹"""
        total_volume = sum(t['volume'] for t in self.tick_window)
        return total_volume / float_volume * 100
```

**æ€§èƒ½è¦æ±‚:**
- ä¸¥ç¦ä½¿ç”¨Pandas DataFrame
- å¿…é¡»ä½¿ç”¨åŸç”ŸPythonï¼ˆdequeï¼‰ä¿è¯å¾®ç§’çº§è®¡ç®—
- æ¯åªè‚¡ç¥¨ç‹¬ç«‹å®ä¾‹ï¼ŒO(1)æ—¶é—´å¤æ‚åº¦

---

### ğŸ—¡ï¸ Phase 4: Tickçº§å¼€ç«é€»è¾‘æ”¹é€ ï¼ˆæ¶ˆç­çº¢ç›˜åè§ï¼‰

**ç›®æ ‡:** æ¸…é™¤æ‰€æœ‰`last_price > pre_close`é™æ€çº¢ç›˜ä»£ç   
**æ–°å¼€ç«æ¡ä»¶ï¼ˆæ»¡è¶³å…¶ä¸€å³å¯ï¼‰:**

**æ¡ä»¶Aï¼ˆç¨³å¥å‹ï¼‰:**
- å®è§‚åœ¨ä¸»å‡è¶‹åŠ¿å†…ï¼ˆMA5>=MA10>=MA20ï¼‰
- åŠ¨æ€é‡æ¯” > 0.95åˆ†ä½
- æ€»æ¢æ‰‹ç‡ > 5%

**æ¡ä»¶Bï¼ˆæ·±æ°´ç‚¸å¼¹/ç¬é—´åŠ¨èƒ½ï¼ŒBossç‰¹æ‰¹ï¼‰:**
- `velocity_60s > 1.5%`ï¼ˆä¸€åˆ†é’Ÿå†…æŠ¢ç­¹æ‹‰å‡è¶…1.5%ï¼‰
- `burst_turnover_60s > 0.15%`ï¼ˆåŠ¨èƒ½åŒºé—´å†…çˆ†é‡ï¼‰
- è§„é¿æ­»äº¡æ¢æ‰‹ï¼ˆ<60%ï¼‰

**æ¸…é™¤æ¸…å•:**
- [ ] `tasks/run_live_trading_engine.py` ä¸­çš„çº¢ç›˜é™åˆ¶
- [ ] `logic/backtest/hot_replay_engine_v20.py` ä¸­çš„çº¢ç›˜é™åˆ¶
- [ ] `logic/strategies/unified_warfare_core.py` ä¸­çš„çº¢ç›˜è¯„åˆ†æƒé‡

---

## ä¸‰ã€å‚æ•°é…ç½®ï¼ˆstrategy_params.jsonï¼‰

```json
{
  "kinetic_radar": {
    "_description": "V20åŠ¨èƒ½é›·è¾¾å‚æ•° - èµ„é‡‘ä¸ºç‹é¡ºåŠ¿è€Œä¸º",
    
    "scan_interval_seconds": 60,
    
    "macro_trend_filter": {
      "ma5_above_ma10": true,
      "close_above_ma20": true,
      "_note": "å¤§é“è‡³ç®€ï¼šåªåšå¤šå¤´æ’åˆ—ä¸»å‡ç¥¨"
    },
    
    "turnover_thresholds": {
      "ratio_to_5d_avg": 1.5,
      "absolute_min_percent": 5.0,
      "absolute_max_percent": 60.0,
      "_note": "5%èµ·æ­¥æ˜¯å¦–è‚¡ï¼Œ60%æ­»äº¡æ¢æ‰‹è§„é¿"
    },
    
    "volume_ratio_percentile": 0.90,
    
    "kinetic_fire_triggers": {
      "velocity_60s_min": 1.5,
      "burst_turnover_60s_min": 0.15,
      "_note": "ä¸€åˆ†é’Ÿæ‹‰å‡1.5%ä¸”çˆ†é‡0.15%å³è§¦å‘"
    }
  }
}
```

---

## å››ã€æ‰§è¡Œçºªå¾‹ä¸éªŒæ”¶æ ‡å‡†

### æ€»ç›‘çº¢çº¿:
1. **åˆ†Phaseæ‰§è¡Œ** - æ¯å®Œæˆä¸€ä¸ªPhaseå¿…é¡»Gitæäº¤
2. **çœŸå®æµ‹è¯•** - æ¯å®Œæˆä¸€ä¸ªPhaseè¿è¡Œ`python main.py live --dry-run`
3. **æ—¥å¿—éªŒæ”¶** - å¿…é¡»çœ‹åˆ°ï¼š
   - `[CTOé›·è¾¾å·¡èˆª] ç¬¬Næ¬¡æ‰«æå®Œæˆ`
   - `è§‚å¯Ÿæ± : XXåª`ï¼ˆåº”è¯¥æ˜¯æ´»è·ƒä¸»å‡æµªç¥¨ï¼Œä¸æ˜¯æ­»æ°´ï¼‰
   - `âœ… æˆåŠŸæ¥æ”¶å¹¶è§£æ Tick`

### BosséªŒæ”¶æ ‡å‡†:
1. é€‰å‡ºçš„ç¥¨ä¸å†æ˜¯å…­å›½åŒ–å·¥ç­‰æ­»æ°´ç¥¨
2. ç³»ç»Ÿæ˜¯æ´»çš„ï¼Œ60ç§’æ‰«æä¸€æ¬¡
3. èƒ½çœ‹åˆ°åŠ¨èƒ½è®¡ç®—å’Œå¼€ç«é€»è¾‘å·¥ä½œ

---

## äº”ã€å½“å‰è¿›åº¦è¿½è¸ª

| Phase | ä»»åŠ¡ | çŠ¶æ€ | å¤‡æ³¨ |
|-------|------|------|------|
| Phase 0 | è‚ƒæ¸…Magic Number | â³ å¾…æ‰§è¡Œ | å…¨éƒ¨RatioåŒ– |
| Phase 1 | å®è§‚åŠ¿èƒ½è¿‡æ»¤ | â³ å¾…æ‰§è¡Œ | MA5/MA10/MA20+5%æ¢æ‰‹åº•çº¿ |
| Phase 2 | 60ç§’æé€Ÿå·¡èˆª | â³ å¾…æ‰§è¡Œ | åŠ¨æ€é›·è¾¾æ´»æ°´ |
| Phase 3 | KineticEngine | â³ å¾…æ‰§è¡Œ | 60ç§’æ»‘åŠ¨çª—å£ |
| Phase 4 | å¼€ç«é€»è¾‘æ”¹é€  | â³ å¾…æ‰§è¡Œ | æ¸…é™¤çº¢ç›˜åè§ |

---

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨:** ç­‰å¾…Boss/CTOç¡®è®¤åï¼Œè°ƒåº¦SubAgentåˆ†Phaseæ‰§è¡Œé‡æ„ã€‚
