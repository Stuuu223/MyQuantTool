# MyQuantTool æŠ€æœ¯æ¶æ„æ–‡æ¡£

> **ç‰ˆæœ¬**: V11.2.0
> **åˆ›å»ºæ—¥æœŸ**: 2026-02-02
> **æœ€åæ›´æ–°**: 2026-02-12
> **å®šä½**: æŠ€æœ¯æ¶æ„æ–‡æ¡£
> **ç›¸å…³æ–‡æ¡£**:
>   - `Q_AND_A_ALIGNMENT.md` - æ ¸å¿ƒç­–ç•¥æ–‡æ¡£ï¼ˆä¸‰å¤§æˆ˜æ³• + Q&Aå¯¹é½ï¼‰
>   - `CLI_USAGE.md` - ä½¿ç”¨æŒ‡å—ï¼ˆå‘½ä»¤è¡Œæ“ä½œ + Rich CLIï¼‰
>   - `PROJECT_STRUCTURE.md` - é¡¹ç›®ç»“æ„è¯´æ˜ï¼ˆæ–‡ä»¶ç»„ç»‡ï¼‰

## ç³»ç»Ÿæ¦‚è¿°

MyQuantTool æ˜¯ä¸€ä¸ªåŸºäºèµ„é‡‘æµå‘åˆ†æçš„å°èµ„é‡‘çŸ­çº¿é‡åŒ–äº¤æ˜“ç³»ç»Ÿï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯åœ¨çŸ­çº¿äº¤æ˜“ä¸­é¿å…è¢«èµ„é‡‘å‡ºè´§å‘æ€ï¼ŒåŒæ—¶æ•æ‰èµ„é‡‘æœ‰åºè¿›æ”»çš„æ ‡çš„ã€‚

### äº¤æ˜“ç­–ç•¥ï¼ˆä¸‰å¤§æˆ˜æ³•ï¼‰
- âœ… **åŠè·¯æˆ˜æ³•**ï¼ˆHalfwayï¼‰- å³ä¾§èµ·çˆ†ç‚¹æ•æ‰
- âœ… **é¾™å¤´æˆ˜æ³•**ï¼ˆLeaderï¼‰- æ¿å—é¾™å¤´è¯†åˆ«
- âœ… **æ—¶æœºæ–§**ï¼ˆTimingï¼‰- æ¿å—å…±æŒ¯æ£€æµ‹

### æŠ€æœ¯æ¶æ„
- âœ… **Rich CLI** - é›¶å»¶è¿Ÿã€è½»é‡çº§ã€äº‹ä»¶é©±åŠ¨
- âœ… **æ•°æ®æŠ½è±¡å±‚** - Level2â†’Level1â†’DongCaiè‡ªåŠ¨é™çº§
- âœ… **äº‹ä»¶é©±åŠ¨ç›‘æ§** - å®æ—¶äº‹ä»¶è§¦å‘æ‰«æ
- âœ… **ä¿¡å·è®°å½•ç³»ç»Ÿ** - 4è¡¨ç»“æ„è¿½è¸ªäº¤æ˜“ç»©æ•ˆ

## æ ¸å¿ƒæ¶æ„

### ä¸‰å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     åº”ç”¨å±‚ (Application)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Rich CLI    â”‚  â”‚  äº‹ä»¶é©±åŠ¨ç›‘æ§  â”‚  â”‚  å›æµ‹å¼•æ“V2   â”‚      â”‚
â”‚  â”‚  ç›‘æ§ç»ˆç«¯     â”‚  â”‚  (å®æ—¶è§¦å‘)    â”‚  â”‚  (ä¿®å¤å¹¸å­˜è€…)  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      é€»è¾‘å±‚ (Logic)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  ä¸‰æŠŠæ–§ä½“ç³»    â”‚  â”‚  ç‰¹å¾è®¡ç®—å±‚    â”‚  â”‚  é£é™©è¯„åˆ†     â”‚      â”‚
â”‚  â”‚  (ä¸‰å¤§æˆ˜æ³•)   â”‚  â”‚  (èµ„é‡‘/æƒ…ç»ª)  â”‚  â”‚  (ç»¼åˆè¯„åˆ†)   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ•°æ®å±‚ (Data)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Level2æ•°æ®   â”‚  â”‚  æ•°æ®æŠ½è±¡å±‚    â”‚  â”‚  å¿«ç…§å­˜å‚¨     â”‚      â”‚
â”‚  â”‚  (ä»˜è´¹é€ç¬”)   â”‚  â”‚ (L2â†’L1â†’Dong) â”‚  â”‚  (SQLite)    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒæ¶æ„è¯¦è§£

### 1. ä¸‰æŠŠæ–§ä½“ç³» (triple_funnel.py)

**èŒè´£**ï¼šå®ç°ä¸‰å¤§æˆ˜æ³•çš„æ ¸å¿ƒé€»è¾‘

#### 1.1 é˜²å®ˆæ–§ï¼ˆå››å±‚æ‹¦æˆªï¼‰
**èŒè´£**ï¼šå¤šå±‚é£æ§æ‹¦æˆªï¼Œé˜²æ­¢è¸©é›·

| å±‚çº§ | æ‹¦æˆªå†…å®¹ | æ£€æµ‹æ–¹å¼ |
|------|----------|----------|
| **é£æ§å±‚** | å°¾ç›˜æ€¥æ‹‰ã€è¯±å¤šé™·é˜± | ä¿¡å·æ£€æµ‹ |
| **è®¢å•æ‰§è¡Œå±‚** | å‡å•ä¿¡å·ã€æ’¤å•å¼‚å¸¸ | QMT Tickæ•°æ® |
| **æ¨¡æ‹Ÿäº¤æ˜“å±‚** | ä»“ä½é™åˆ¶ã€æ­¢æŸæ£€æŸ¥ | é£æ§ç®¡ç†å™¨ |
| **ç›‘æ§å±‚** | èµ„é‡‘æµé¢„è­¦ã€æ¿å—å…±æŒ¯ | å®æ—¶ç›‘æ§ |

#### 1.2 èµ„æ ¼æ–§ï¼ˆåœºæ™¯åˆ†ç±»ï¼‰
**èŒè´£**ï¼šè¯†åˆ«ä¸‰å¤§æˆ˜æ³•åœºæ™¯

| åœºæ™¯ | è¯†åˆ«æ¡ä»¶ | ä¿¡å·ç±»å‹ |
|------|----------|----------|
| **ä¸»çº¿èµ·çˆ†** | æ¿å—å…±æŒ¯ + é¾™å¤´åŠ é€Ÿ | STRONG_BUY |
| **æ‹‰é«˜å‡ºè´§** | èµ„é‡‘æµå‡º + æ¶¨å¹…>10% | SELL |
| **è¡¥æ¶¨å°¾å£°** | è·Ÿé£è‚¡ + èµ„é‡‘å¼± | HOLD |

#### 1.3 æ—¶æœºæ–§ï¼ˆæ¿å—å…±æŒ¯ï¼‰
**èŒè´£**ï¼šåˆ¤æ–­æ¿å—å…±æŒ¯çŠ¶æ€

**å…±æŒ¯æ¡ä»¶**ï¼š
- **Leaders â‰¥ 3**: æ¿å—å†…æ¶¨åœè‚¡æ•°é‡
- **Breadth â‰¥ 35%**: æ¿å—å†…ä¸Šæ¶¨è‚¡æ¯”ä¾‹
- **å…±æŒ¯çŠ¶æ€**: ğŸ”¥å…±æŒ¯ / ğŸ“Šè§‚å¯Ÿ / â„ï¸é€†é£

**å…³é”®æ–¹æ³•**ï¼š
- `calculate_sector_resonance()`: æ¿å—å…±æŒ¯è®¡ç®—
- `get_resonance_status()`: å…±æŒ¯çŠ¶æ€åˆ¤æ–­

### 2. ç‰¹å¾è®¡ç®—å±‚

#### 2.1 å¤šæ—¥é£é™©ç‰¹å¾ (rolling_risk_features.py)

**èŒè´£**ï¼šè®¡ç®—å¤šæ—¥èµ„é‡‘æµå‘å’Œä»·æ ¼å˜åŒ–ç‰¹å¾

**æ ¸å¿ƒå‡½æ•°**ï¼š
```python
compute_multi_day_risk_features(code, trade_date, flow_records, price_3d_change)
```

**è¾“å‡ºç‰¹å¾**ï¼š
- `is_price_up_3d_capital_not_follow`: 3æ—¥è¿æ¶¨ä½†èµ„é‡‘ä¸è·Ÿ
- `price_3d_change`: 3æ—¥ä»·æ ¼æ¶¨å¹…
- `capital_3d_net_sum`: 3æ—¥èµ„é‡‘å‡€æµå…¥åˆè®¡

#### 2.2 è¯±å¤šé™·é˜±æ£€æµ‹ (trap_detector.py)

**èŒè´£**ï¼šæ£€æµ‹è¯±å¤šé™·é˜±ä¿¡å·

**æ£€æµ‹ä¿¡å·**ï¼š
- é•¿æœŸæµå‡º+å•æ—¥å·¨é‡
- æš´é‡*2 (è¿ç»­ä¸¤å¤©æš´é‡)
- æš´é‡*3 (è¿ç»­ä¸‰å¤©æš´é‡)
- æ¸¸èµ„çªè¢­
- å†²é«˜å›è½

#### 2.3 èµ„é‡‘æ€§è´¨åˆ†ç±» (capital_classifier.py)

**èŒè´£**ï¼šæ ¹æ®èµ„é‡‘æµå‘æ¨¡å¼åˆ†ç±»èµ„é‡‘æ€§è´¨

**åˆ†ç±»ç±»å‹**ï¼š
- `HOTMONEY`: æ¸¸èµ„ï¼ˆçŸ­æœŸã€æ³¢åŠ¨å¤§ï¼‰
- `INSTITUTIONAL`: æœºæ„ï¼ˆé•¿æœŸã€ç¨³å®šï¼‰
- `RETAIL`: æ•£æˆ·ï¼ˆæ¥ç›˜ï¼‰
- `UNKNOWN`: æœªçŸ¥

### 3. æ•°æ®å±‚æ¶æ„

#### 3.1 æ•°æ®æŠ½è±¡å±‚ï¼ˆV11.2.0 æ–°å¢ï¼‰

**ä¸‰å±‚æ¶æ„**ï¼š
```
ç­–ç•¥å±‚ï¼ˆä¸‰æŠŠæ–§ï¼‰
    â†“
æŠ½è±¡å±‚ï¼ˆICapitalFlowProviderï¼‰
    â†“
æ•°æ®æºå±‚ï¼ˆLevel2 â†’ Level1 â†’ DongCaiï¼‰
```

**æ ¸å¿ƒæ¥å£**ï¼š
```python
# logic/data_provider/base.py
class ICapitalFlowProvider(ABC):
    @abstractmethod
    def get_fund_flow(self, code: str, days: int) -> Dict:
        pass
```

**è‡ªåŠ¨é™çº§æœºåˆ¶**ï¼š
```
Level-2ï¼ˆä»˜è´¹é€ç¬”æ•°æ®ï¼‰
    â†“ ä¸å¯ç”¨/æ— æƒé™
Level-1ï¼ˆQMT Tickæ¨æ–­ï¼‰
    â†“ ä¸å¯ç”¨/QMTæœªç™»å½•
DongCaiï¼ˆä¸œæ–¹è´¢å¯ŒT-1å†å²ï¼‰
```

**å…³é”®æ–¹æ³•**ï¼š
- `get_available_providers()`: è·å–å¯ç”¨çš„æä¾›è€…
- `get_fund_flow_with_fallback()`: å¸¦é™çº§çš„èµ„é‡‘æµè·å–
- `auto_select_provider()`: è‡ªåŠ¨é€‰æ‹©æœ€ä½³æ•°æ®æº

#### 3.2 å¿«ç…§å­˜å‚¨ (cache_replay_provider.py)

**èŒè´£**ï¼šå¿«ç…§çš„ä¿å­˜å’Œå›æ”¾

**å¿«ç…§æ ¼å¼**ï¼š
```json
{
  "scan_time": "2026-02-06T09:45:21.390438",
  "mode": "intraday",
  "results": {
    "opportunities": [...],
    "watchlist": [...]
  }
}
```

**å…³é”®æ–¹æ³•**ï¼š
- `save_snapshot()`: ä¿å­˜å¿«ç…§
- `load_snapshot()`: åŠ è½½å¿«ç…§
- `list_snapshots()`: åˆ—å‡ºæ‰€æœ‰å¿«ç…§

#### 3.3 QMT Tickæ¨æ–­é€»è¾‘ï¼ˆV11.2.0 æ–°å¢ï¼‰

**æ¨æ–­å…¬å¼**ï¼š
```python
estimated_main_flow = (
    base_flow * 0.4 +                      # å†å²åŸºç¡€ 40%
    amount * (bid_pressure - 1.0) * 0.3 +  # ä¹°å–å‹åŠ› 30%
    amount * price_strength * 0.3          # ä»·æ ¼å¼ºåº¦ 30%
)
```

**å…³é”®æ–¹æ³•**ï¼š
- `estimate_flow_from_tick()`: ä»Tickæ¨æ–­èµ„é‡‘æµ
- `calculate_bid_pressure()`: è®¡ç®—ä¹°å–ç›˜å‹åŠ›
- `calculate_price_strength()`: è®¡ç®—ä»·æ ¼å¼ºåº¦

#### 3.2 è‚¡æœ¬æ•°æ® (data/equity_info_tushare.json)

**èŒè´£**ï¼šå­˜å‚¨è‚¡ç¥¨è‚¡æœ¬ä¿¡æ¯ï¼Œç”¨äºè®¡ç®—ratio

**æ•°æ®ç»“æ„**ï¼š
```json
{
  "2026-02-06": {
    "601869.SH": {
      "total_share": 10000000000,
      "float_share": 5000000000,
      "circ_mv": 71015747138
    }
  }
}
```

## æ•°æ®æµ

### å®æ—¶æ‰«ææµç¨‹

```
1. QMTè·å–å®æ—¶Tickæ•°æ®
   â†“
2. full_market_scanner åˆå§‹åŒ–
   â†“
3. å¯¹æ¯åªè‚¡ç¥¨ï¼š
   - è·å–èµ„é‡‘æµå‘æ•°æ® (flow_data)
   - è®¡ç®—ratio = main_net_inflow / circ_mv * 100
   - è®¡ç®—é£é™©ç‰¹å¾ (trap_signals, risk_features)
   - è®¡ç®—é£é™©è¯„åˆ† (risk_score)
   - åˆ†ç±»èµ„é‡‘æ€§è´¨ (capital_type)
   â†“
4. å†³ç­–æ ‘åˆ¤æ–­ (_calculate_decision_tag)
   â†“
5. ç”Ÿæˆå¿«ç…§ (save_snapshot)
```

### å›æ”¾æµç¨‹

```
1. cache_replay_provider åŠ è½½å¿«ç…§
   â†“
2. è¯»å–å¿«ç…§ä¸­çš„ results.opportunities
   â†“
3. æ˜¾ç¤ºå†³ç­–ç»“æœå’ŒåŸå› 
   â†“
4. å¯é€‰ï¼šä¸å®é™…äº¤æ˜“è®°å½•å¯¹æ¯”
```

## æ¨¡å—ä¾èµ–å…³ç³»

```
triple_funnel.pyï¼ˆä¸‰æŠŠæ–§ä½“ç³»ï¼‰
â”œâ”€â”€ defense_axe.pyï¼ˆé˜²å®ˆæ–§ï¼‰
â”œâ”€â”€ qualification_axe.pyï¼ˆèµ„æ ¼æ–§ï¼‰
â”œâ”€â”€ timing_axe.pyï¼ˆæ—¶æœºæ–§ï¼‰
â”œâ”€â”€ trap_detector.pyï¼ˆè¯±å¤šä¿¡å·ï¼‰
â”œâ”€â”€ rolling_risk_features.pyï¼ˆå¤šæ—¥ç‰¹å¾ï¼‰
â”œâ”€â”€ capital_classifier.pyï¼ˆèµ„é‡‘æ€§è´¨ï¼‰
â””â”€â”€ sector_resonance.pyï¼ˆæ¿å—å…±æŒ¯ï¼‰

data_provider_factory.pyï¼ˆæ•°æ®æŠ½è±¡å±‚ï¼‰
â”œâ”€â”€ ICapitalFlowProviderï¼ˆæ¥å£ï¼‰
â”œâ”€â”€ level2_provider.pyï¼ˆLevel2æ•°æ®ï¼‰
â”œâ”€â”€ level1_provider.pyï¼ˆLevel1æ•°æ® + QMT Tickæ¨æ–­ï¼‰
â””â”€â”€ dongcai_provider.pyï¼ˆä¸œæ–¹è´¢å¯ŒT-1å†å²ï¼‰

cli_monitor.pyï¼ˆRich CLIç›‘æ§ç»ˆç«¯ï¼‰
â”œâ”€â”€ triple_funnel.pyï¼ˆä¸‰æŠŠæ–§ï¼‰
â”œâ”€â”€ cache_replay_provider.pyï¼ˆå¿«ç…§åŠ è½½ï¼‰
â””â”€â”€ data/monitor_state.jsonï¼ˆçŠ¶æ€å¯¼å‡ºï¼‰

run_event_driven_monitor.pyï¼ˆäº‹ä»¶é©±åŠ¨ç›‘æ§ï¼‰
â”œâ”€â”€ triple_funnel.py
â”œâ”€â”€ cli_monitor.py
â””â”€â”€ event_recorder.pyï¼ˆä¿¡å·è®°å½•ï¼‰

backtest_engine_v2.pyï¼ˆå›æµ‹å¼•æ“V2ï¼‰
â”œâ”€â”€ triple_funnel.pyï¼ˆä¸‰æŠŠæ–§ï¼‰
â”œâ”€â”€ cache_replay_provider.pyï¼ˆå¿«ç…§åŠ è½½ï¼‰
â””â”€â”€ signal_recorder.pyï¼ˆä¿¡å·è®°å½•ï¼‰
```

## å¼€å‘è§„èŒƒ

### 1. æ·»åŠ æ–°ç‰¹å¾

**æ­¥éª¤**ï¼š
1. åœ¨ `logic/` ä¸‹åˆ›å»ºç‰¹å¾è®¡ç®—æ¨¡å—ï¼ˆå¦‚ `rolling_risk_features.py`ï¼‰
2. å®ç°ç‰¹å¾è®¡ç®—å‡½æ•°ï¼Œè¿”å›å­—å…¸å½¢å¼
3. åœ¨ `triple_funnel.py` æˆ–ç›¸å…³æ¨¡å—ä¸­è°ƒç”¨
4. å°†ç‰¹å¾æŒ‚è½½åˆ° `result['risk_features']`
5. åœ¨ä¸‰æŠŠæ–§ä½“ç³»ä¸­ä½¿ç”¨ç‰¹å¾

**ç¤ºä¾‹**ï¼š
```python
# logic/rolling_risk_features.py
def compute_multi_day_risk_features(...) -> Dict:
    return {
        "is_price_up_3d_capital_not_follow": True,
        "price_3d_change": 3.5,
        "capital_3d_net_sum": -4200000.0
    }

# triple_funnel.py
risk_features = compute_multi_day_risk_features(...)
result['risk_features'] = risk_features
decision_tag = self._apply_defense_axe(
    ratio=ratio,
    risk_score=risk_score,
    trap_signals=trap_signals,
    is_price_up_3d_capital_not_follow=risk_features['is_price_up_3d_capital_not_follow']
)
```

### 2. æ·»åŠ æ–°æ‹¦æˆªè§„åˆ™

**æ­¥éª¤**ï¼š
1. åœ¨ `triple_funnel.py` çš„ `_apply_defense_axe()` ä¸­æ·»åŠ æ–°çš„æ‹¦æˆªæ¡ä»¶
2. ç¡®ä¿æ‹¦æˆªé¡ºåºæ­£ç¡®ï¼ˆä»ä¸¥æ ¼åˆ°å®½æ¾ï¼‰
3. æ·»åŠ å•å…ƒæµ‹è¯•åˆ° `tests/test_triple_funnel_regression.py`
4. è¿è¡Œæµ‹è¯•ç¡®ä¿ä¸ç ´åç°æœ‰é€»è¾‘

**ç¤ºä¾‹**ï¼š
```python
def _apply_defense_axe(self, ratio, risk_score, trap_signals, new_feature=False):
    # é˜²å®ˆæ–§ç¬¬1å±‚ï¼šratioæ£€æŸ¥
    if ratio < 0:
        return {"tag": "PASSâŒ", "reason": "è´Ÿratioï¼Œèµ„é‡‘æµå‡º"}
    if ratio > 5:
        return {"tag": "TRAPâŒ", "reason": "ratio > 5%ï¼Œå¯èƒ½è¯±å¤š"}

    # æ–°æ‹¦æˆªå±‚
    if new_feature and ratio < 1:
        return {"tag": "NEW_TAGâŒ", "reason": "æ–°ç‰¹å¾è§¦å‘æ‹¦æˆª"}

    # ...
```

### 3. å•å…ƒæµ‹è¯•

**æµ‹è¯•è¦†ç›–**ï¼š
- æ¯ä¸ªæ‹¦æˆªå±‚çš„è¾¹ç•Œæ¡ä»¶
- ä¸‰å¤§æˆ˜æ³•åœºæ™¯çš„å„ç§ç»„åˆ
- å›å½’æµ‹è¯•ï¼ˆç¡®ä¿ä¸ç ´åç°æœ‰é€»è¾‘ï¼‰

**æµ‹è¯•æ–‡ä»¶**ï¼š`tests/test_triple_funnel_regression.py`

## æ€§èƒ½ä¼˜åŒ–

### 1. æ•°æ®ç¼“å­˜
- è‚¡æœ¬æ•°æ®ä½¿ç”¨ Tushare ç¼“å­˜
- å¿«ç…§æ•°æ®æŒ‰æ—¶é—´ç‚¹ä¿å­˜

### 2. å¹¶å‘å¤„ç†
- ä½¿ç”¨å¤šçº¿ç¨‹è·å–èµ„é‡‘æµå‘æ•°æ®
- æ‰¹é‡å¤„ç†è‚¡ç¥¨æ•°æ®

### 3. å¢é‡æ›´æ–°
- åªæ›´æ–°å˜åŒ–çš„è‚¡ç¥¨
- é¿å…é‡å¤è®¡ç®—

## æ‰©å±•æ–¹å‘

### 1. ä¿¡å·è®°å½•ç³»ç»Ÿï¼ˆV11.2.0 æ–°å¢ï¼‰
- å®Œå–„4è¡¨ç»“æ„ï¼ˆopportunities, watchlist, blocked, signalsï¼‰
- é›†æˆåˆ°CLIç›‘æ§ç»ˆç«¯
- å®ç°ä¿¡å·å†å²æŸ¥è¯¢å’Œç»Ÿè®¡åˆ†æ

### 2. å›æµ‹å¼•æ“V2ï¼ˆV11.2.0 å·²å®ç°ï¼‰
- ä¿®å¤å¹¸å­˜è€…åå·®
- æ¨¡æ‹ŸæŒä»“
- è®¡ç®—æ”¶ç›Šç‡ã€èƒœç‡ã€ç›ˆäºæ¯”
- éªŒè¯ç­–ç•¥æœ‰æ•ˆæ€§

### 3. å†å²æ•°æ®é‡å»º
- ä½¿ç”¨ Tushare é‡å»ºå†å²å¿«ç…§
- é•¿å‘¨æœŸå›æµ‹
- ç­–ç•¥ä¼˜åŒ–
- éªŒè¯å†å²è¡¨ç°

### 4. æ¦‚å¿µæ¿å—å…±æŒ¯
- ä»ç”³ä¸‡è¡Œä¸šåˆ‡æ¢åˆ°åŒèŠ±é¡ºæ¦‚å¿µ
- æå‡æ¦‚å¿µæ¿å—è¦†ç›–ç‡è‡³100%
- æ›´æ–°æ¿å—å…±æŒ¯è®¡ç®—é€»è¾‘

### 5. é£æ§ç³»ç»Ÿå¢å¼º
- å¢åŠ æ›´å¤šé£æ§æŒ‡æ ‡
- å®ç°åŠ¨æ€ä»“ä½ç®¡ç†
- å¢åŠ æç«¯è¡Œæƒ…ä¿æŠ¤

## å¸¸è§é—®é¢˜

### Q1: ratio æ˜¯æ€ä¹ˆè®¡ç®—çš„ï¼Ÿ
```python
ratio = main_net_inflow / circ_mv * 100
```
- `main_net_inflow`: ä¸»åŠ›å‡€æµå…¥ï¼ˆå…ƒï¼‰
- `circ_mv`: æµé€šå¸‚å€¼ï¼ˆå…ƒï¼‰
- ç»“æœè¡¨ç¤ºä¸»åŠ›èµ„é‡‘å æµé€šå¸‚å€¼çš„ç™¾åˆ†æ¯”

### Q2: ä»€ä¹ˆæ˜¯ä¸‰æŠŠæ–§ä½“ç³»ï¼Ÿ
- **é˜²å®ˆæ–§**ï¼šå››å±‚æ‹¦æˆªï¼Œé˜²æ­¢è¸©é›·
- **èµ„æ ¼æ–§**ï¼šåœºæ™¯åˆ†ç±»ï¼Œè¯†åˆ«æˆ˜æ³•æœºä¼š
- **æ—¶æœºæ–§**ï¼šæ¿å—å…±æŒ¯ï¼Œåˆ¤æ–­å¸‚åœºæ—¶æœº

### Q3: æ•°æ®æŠ½è±¡å±‚å¦‚ä½•å·¥ä½œï¼Ÿ
- ä¼˜å…ˆä½¿ç”¨ Level2 æ•°æ®ï¼ˆä»˜è´¹é€ç¬”ï¼‰
- ä¸å¯ç”¨æ—¶é™çº§åˆ° Level1ï¼ˆQMT Tickæ¨æ–­ï¼‰
- å†ä¸å¯ç”¨æ—¶ä½¿ç”¨ DongCaiï¼ˆä¸œæ–¹è´¢å¯ŒT-1å†å²ï¼‰

### Q4: å¦‚ä½•æ·»åŠ æ–°çš„æ‹¦æˆªè§„åˆ™ï¼Ÿ
åœ¨ `triple_funnel.py` çš„ `_apply_defense_axe()` ä¸­æ·»åŠ æ–°çš„æ‹¦æˆªæ¡ä»¶ï¼Œç„¶åè¿è¡Œå•å…ƒæµ‹è¯•ç¡®ä¿ä¸ç ´åç°æœ‰é€»è¾‘ã€‚

### Q5: å¦‚ä½•è°ƒè¯•ä¸‰æŠŠæ–§ä½“ç³»ï¼Ÿ
1. ä½¿ç”¨ `python tools/cli_monitor.py --debug` è¿è¡Œç›‘æ§
2. æŸ¥çœ‹ `data/monitor_state.json` äº†è§£è¯¦ç»†çŠ¶æ€
3. æŸ¥çœ‹å•å…ƒæµ‹è¯•ç”¨ä¾‹ç†è§£è¾¹ç•Œæ¡ä»¶

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒï¼š
- `Q_AND_A_ALIGNMENT.md` - æ ¸å¿ƒç­–ç•¥æ–‡æ¡£ï¼ˆä¸‰å¤§æˆ˜æ³•ï¼‰
- `CLI_USAGE.md` - ä½¿ç”¨æŒ‡å—ï¼ˆå‘½ä»¤è¡Œæ“ä½œï¼‰
- `tests/test_triple_funnel_regression.py` - æµ‹è¯•ç”¨ä¾‹
- `data/monitor_state.json` - ç›‘æ§çŠ¶æ€ç¤ºä¾‹
- `tools/cli_monitor.py` - CLIç›‘æ§ç»ˆç«¯