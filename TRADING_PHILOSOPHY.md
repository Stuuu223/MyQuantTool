# 右侧起爆猎杀系统 - 交易哲学

> **"资金为王，顺势而为，追随市场短线大哥，排除杂毛，小资金效率极致化，利用体量优势（船小好掉头）。"**  
> —— 系统灵魂准则

---

## 一、核心哲学

### 1. 资金为王
- 一切技术分析必须让位于资金流向
- 只有真金白银堆出来的上涨才是真上涨
- 量能决定一切，无量上涨皆是骗炮

### 2. 顺势而为
- 只打右侧，绝不左侧抄底
- 趋势是朋友，逆势是坟墓
- 大盘情绪>板块情绪>个股情绪

### 3. 追随市场短线大哥
- 只做板块龙头，不做跟风杂毛
- 大哥吃肉，二哥喝汤，三哥吃面
- 宁打龙头一次，不碰杂毛十次

### 4. 排除杂毛
- 流通盘<50亿或>500亿的不看
- 非热点板块的不看
- 没有板块共振的不看
- 量价背离的不看

### 5. 小资金效率极致化
- 早盘30分钟内必须打完子弹
- 单吊100%仓位龙1
- 当日不成交立即撤单
- 绝不补仓，错了就砍

### 6. 利用体量优势
- 船小好掉头，见势不妙秒撤
- 不恋战，有利就跑
- 积小胜为大胜

---

## 二、系统三大核心

### 1. 全息回演（时间机器）
**目的**：验证V18动能引擎在历史数据上的胜率

**原则**：
- 只做时间序列回测（单票Tick驱动）
- 不加入板块情绪（横截面计算会导致内存爆炸）
- 目标是验证"右侧起爆"信号的准确性

**禁止**：
- 禁止在全息回演中加入假资金流数据
- 禁止使用模拟板块情绪
- 禁止为了提高回测胜率而篡改数据

### 2. 实盘猎杀（战争机器）
**目的**：在真实市场中执行右侧起爆策略

**执行流程**：
1. **09:20-09:25** 盘前装弹
   - QMT本地读取FloatVolume/涨停价
   - QMT本地数据获取5日均量
   - 数据缺失>5%则系统熔断

2. **09:30-09:35** 极速扫描
   - 向量化扫描全市场（<10ms）
   - V18动能引擎实时算分
   - TradeGatekeeper三斧齐下

3. **09:35后** 机会捕捉
   - 只关注Top 10真龙候选
   - Tick级EventDriven监控
   - 满足条件秒下单

**风控红线**：
- 单笔不超过2万
- 最多3只持仓
- 09:35后不开新仓
- 废单5秒不成交立即撤

### 3. V18动能引擎（验钞机）
**核心算法**：
- **双Ratio化过滤**：动态量比>分位数阈值 + 每分钟换手率>0.2%
- **时间衰减权重**：09:30-09:40(1.2倍)、09:40-10:30(1.0倍)、10:30-14:00(0.8倍)、14:00-14:55(0.5倍)
- **物理学验钞**：动能30分(净流入占比) + 势能30分(相对历史爆发力) + 价格推力40分(日内K线推力)
- **神级乘数区**：维持能力、筹码纯度、吸血效应、早盘时间坚决度

**True Dragon Score物理核心**：
- **动能打分**：净流入占流通市值比例 (权重30分) - 游资逻辑：看占流通盘百分比而非绝对金额
- **势能打分**：相对自身历史爆发力倍数 (权重30分) - 今天5分钟脉冲是平时死水状态的多少倍？
- **价格动能**：日内K线推力强度 (权重40分) - (当前价-最低价)/(最高价-最低价)
- **MFE效率算子**：向上推力百分比/净流入占比 - 单位资金做功的向上效率

**神级乘数机制**：
- **维持能力**：15分钟/5分钟资金比值 > 1.2则乘数1.5倍，< 1.0则乘数0.5倍
- **筹码纯度**：空间差 < 10%则乘数1.2倍
- **吸血效应**：流入占比 > 1.5%则乘数1.2倍
- **时间坚决度**：早盘9:40前乘数1.2倍，尾盘14:00后乘数0.5倍

**排除项**：
- 涨停股不买（买不到）
- 跌停股不买（是坑）
- 尾盘拉升不买（骗炮）
- 无量上涨不买（虚）

---

## 三、TradeGatekeeper三斧

### 第一斧：防守斧（资金流检查）
**目的**：防止高位微观动能滞涨接盘

**触发条件**（满足任一即拦截）：
1. 3分钟内成交量暴增3倍，但微观动能系数<0.5%（放量滞涨）
2. 买盘突然撤单，卖盘巨增（盘口诱多陷阱）
3. 价格推力系数断崖下跌（主力出货信号）

**执行**：直接打上TRAP❌标签，一票否决

### 第二斧：时机斧（板块物理势能检查）
**目的**：只打板块共振（*该功能尚未完全实现，当前为测试阶段*）

**通过条件**（必须同时满足）：
1. 板块内动能领袖股≥3只（微观势能已激活）
2. 板块内物理势能密度>40%（跟风资金已进场）

**执行**：不满足则降级到观察池，不进入机会池

### 第三斧：守门人（综合决策）
**目的**：最终把关

**决策树**：
1. 防守斧拦截 → 直接PASS❌
2. 时机斧降级 → 进入观察池⏸️
3. 双斧通过 → 进入机会池🎯
4. V18物理学验钞得分≥70 → 触发买入信号🚨

---

## 四、V20动能架构（2026-02-27 CTO终极净化版）

### 4.1 宏微观四步猎杀法
**核心升级**：从静态筛选到动态监控，从红盘偏见到动能捕捉

**四步法**：
1. **宏观势能过滤**：均线多头排列 + 活跃度Ratio
2. **动态雷达巡航**：60秒一轮全市场快照
3. **微观物理引擎**：Tick级动能计算
4. **精准开火逻辑**：基于动能而非红盘

### 4.2 MFE指标优化
**MFE向上做功**：
- 使用 `(price-low + high_open)/2` 过滤天地板
- 避免极端价格波动的干扰
- 确保指标在合理范围（0.52~1.09）

**一字板惩罚**：
- 对MFE > 5.0的股票进行倒扣分
- 避免缩量秒板等无意义涨停
- 保持评分系统有效性

### 4.3 流入比保护
- 添加 `float_market_cap > 1000` 检查
- 流入比限制在 -50%~50% 范围内
- 防止异常值对系统的影响

---

## 五、技术规范

### 1. 数据真实性原则
- FloatVolume必须用QMT原生接口获取
- 5日均量必须用QMT本地历史数据计算
- 严禁使用任何估算公式（amount/1e8等）
- 盘中严禁任何网络请求

### 2. 性能极致原则
- 5000只股票扫描<10ms
- 只使用向量化操作（df.map）
- 严禁使用iterrows循环
- 所有数据必须内存O(1)查询

### 3. 系统熔断原则
- TrueDictionary未预热 → 系统停止
- 数据缺失率>5% → 系统停止
- QMT连接断开 → 系统停止
- 连续3单废单 → 系统停止

---

## 六、禁忌清单

### 绝对禁止
- [ ] 禁止左侧抄底
- [ ] 禁止持仓过夜（除非涨停）
- [ ] 禁止补仓摊低成本
- [ ] 禁止单笔满仓
- [ ] 禁止追逐杂毛股
- [ ] 禁止使用假数据
- [ ] 禁止在实盘用模拟测试

### 严格限制
- [ ] 限制早盘30分钟后不开新仓
- [ ] 限制最多3只持仓
- [ ] 限制单笔不超过2万
- [ ] 限制废单停留不超过5秒

---

## 七、成功标准

### 日度标准
- 当日成交率>80%
- 当日胜率>60%
- 当日最大回撤<3%

### 月度标准
- 月收益>30%
- 最大连续亏损<3天
- 资金曲线稳定向上

### 年度标准
- 年收益>280%
-  survived所有黑天鹅
- 资金曲线夏普比率>2

---

## 八、系统架构极简原则

### 保留目录
```
MyQuantTool/
├── config/              # 只留config.json和strategy_params.json
├── data/               # 回测数据、缓存
├── logic/              # 核心逻辑
│   ├── data_providers/ # TrueDictionary, QMTManager
│   ├── strategies/     # V18引擎, FullMarketScanner
│   └── execution/      # TradeGatekeeper, TradeInterface
├── tasks/              # 实盘总控引擎
├── main.py             # 唯一入口
├── TRADING_PHILOSOPHY.md  # 本文件（系统灵魂）
└── requirements.txt    # 依赖
```

### 删除目录
- [x] output/           # 已删除
- [x] archive/          # 已删除
- [x] tests/            # 合并到主流程
- [x] tools/            # 只留必要脚本
- [x] docs/             # 合并到本文件

---

## 九、最新架构演进 (V20.5)

### 9.1 CTO终极净化 (2026-02-27)
**成果**：
- MFE向上做功优化（过滤天地板）
- 流入比保护（市值检查+限幅）
- MFE一字板惩罚（避免缩量秒板）
- 两看板100%一致验证

### 9.2 数据源统一 (SSOT)
- 统一数据源原则实施
- 所有计算基于QMT本地数据
- 避免数据不一致性

---

**最后更新时间**: 2026-02-28  
**版本**: v2.5.0 - V20终极净化版  
**状态**: 系统已优化